# **Bioinformatics Solutions for Mpox Genomic Analysis**

PHA4GE Bioinformatics Pipelines &amp; Visualization Working Group <br/>
Authors:

<details>
 <summary> Document Changelog</summary>
 
- 2024-08-29:
  - First draft published
</details>

# Overview




| Approach           | Input files                               | Output files                                                                       | Tools                                                                                                                                                                                                                                         | Lab protocol                                    | Primer scheme                                                                                                  | Installation<br>(source, workflow, docker, etc?)                                                                    | Recommended RAM                                                                 | OS                                                                                                                  | Web/cloud                            | Link                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Recommended (Add an X) |   |
| -------------------- | ------------------------------------------- | ------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------- | -------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ | --- |
| EPI2ME             | FASTQ<br>bam                              | consensus.fa<br>bam<br>vcf                                                         | <br>Minimap2 – alignment to ref<br>Flye – De Novo assembly<br>Medaka – variant calling <br>Bcftools – creates variant consensus                                                                                                           | metagenomic data                                | N/A, not designed for tiled amplicon data, although likely adequate for clade typing                           | Source, Nextflow, Singularity and Docker, Desktop app                                                               | CPUs = 4<br>Memory = 16GB<br>Minimum requirements:<br>CPUs = 4<br>Memory = 10GB | Windows 10 through WSL2<br>macOS Intel        <br>macOS M1/M2        <br>Ubuntu / Debian        <br>RHEL 8+ / Rocky | -                                    | https://labs.epi2me.io/basic-mpox-workflow/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                        |   |
| UPHL               | FASTQ<br>FASTA                            | bam<br>consensus.fa<br>treefile (newick)<br>vcf                                    | fastp/fastqc (raw reads QC)<br>Kraken (read classification)<br>bwa/Minimap2 (alignment)<br>ivar (primer trimming + consensus)<br>samtools (primer trimming, amplicon clipping)<br>mafft/nextalign (MSA)<br>IQTree (phylogenetics)<br>SNP-dist | amplicon and metagenomics                       | metagenomics<br>IDT<br>Yale                                                                                    | Nextflow, Singularity and Docker                                                                                    | Not stated                                                                      | Linux                                                                                                               | Additional config options are needed | https://github.com/UPHL-BioNGS/Cecret#monkeypox                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                        |   |
| Viridian           | FASTQ<br>FASTA<br>bam<br>Run Accession ID | bam<br>consensus.fa<br>MSA<br>VCF                                                  | Minimap2<br>Samtools<br>Pysam<br>Cyclon/Racon                                                                                                                                                                                                 | tiled amplicon data: Illumina, ONT, Ion torrent | - Built in support for common SARS-CoV-2 schemes<br>- User can manually specify schemes in 7 column BED format | Docker, SIngularity                                                                                                 | Not stated                                                                      | -                                                                                                                   | -                                    | https://github.com/iqbal-lab-org/viridian                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                        |   |
| Artic ONT          | FASTQ (demultiplexed sequence reads)      | <br>bam<br>consensus.fa<br>vcf<br>Pangolin lineage_report.csv<br>nextclade.json    | fastcat/bamstats (concatenate multifile samples)<br>minimap2<br>Medaka <br>NextClade<br>Pangolin                                                                                                                                              | pooled tiling amplicon: ONT                     | Built in:<br>- Yale<br>- Erasmus<br>Else user specified                                                        | Source, Nextflow, Singularity, Docker, Desktop app via EPI2ME                                                       | 8GB                                                                             | -                                                                                                                   | -                                    | https://github.com/artic-network/artic-mpxv-nf                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                        |   |
| Artic Illumina     | FASTQ                                     | <br>bam<br>consensus.fa<br>vcf<br>Pangolin lineage_report.csv<br>nextclade.json    | trim_galore<br>Bwa/BBMap<br>Samtools<br>Bcftools<br>ivar<br>Freebayes<br>MAFFT                                                                                                                                                                | pooled tiling amplicon: Illumina                | Built in:<br>- Yale<br>- Erasmus<br>Else user specified                                                        | Nextflow<br>conda                                                                                                   | 8GB                                                                             | -                                                                                                                   | -                                    | https://github.com/artic-network/artic-mpxv-illumina-nf                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                        |   |
| Galaxy             | -                                         | -                                                                                  | -                                                                                                                                                                                                                                             | -                                               | -                                                                                                              | Could install a local instance, but it requires a Sysadmin. Otherwise via web                                       | -                                                                               | -                                                                                                                   | web                                  | https://galaxyproject.org/projects/mpxv/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                        |   |
| TheiaCoV           | FASTQ                                     | <br>bam<br>consensus.fa<br>nextclade.json<br>nextclade.tsv<br>vcf<br>vadr.alt.list | NCBI SRA-Human-Scrubber<br>FastQC<br>Kraken<br>Trimmomatic and BBDuk<br>BWA/Samtools<br>iVar<br>minimap2<br>Pangolin/NextClade                                                                                                                | amplicon and metagenomic data                   | User-defined                                                                                                   | Requires  Google and Terra accounts<br>Internet connection: at least 10 and 5Mbps for<br>download and upload speeds | -                                                                               | -                                                                                                                   | cloud                                | https://theiagen.notion.site/Workspace-Reference-Materials-for-MPXV-Genomic-Characterization-a34f355c68c54c0a82e926d4de607bca<br><br>https://app.terra.bio/<br><br><br>https://support.terra.bio/hc/en-us<br><br>https://file.notion.so/f/f/be290196-9090-4f3c-a9ab-fe730ad213e0/0b80701f-d4cd-4873-850e-8007e3f5ec78/TG-SC2-PE_SC2_TheiaCoV_IlluminaPE_v3.pdf?table=block&id=e6208fae-401e-4740-9c6d-794a192de1f6&spaceId=be290196-9090-4f3c-a9ab-fe730ad213e0&expirationTimestamp=1725048000000&signature=M6uaDZH3pY3y7q7vJ9opM0iHiK5mrOkcSKJy0vad0_E&downloadName=TG-SC2-PE_SC2_TheiaCoV_IlluminaPE_v3.pdf |                        |   |
| genomicsITER (ONT) | FASTQ                                     | <br><br>bam<br>consensus.fa<br>Newick<br>nextclade.json                            | fastp<br>Kraken2<br>Unicycler (de novo)<br>QUAST (QC of de novo)<br>minimap<br>Samtools/BCFtools<br>Seqtk                                                                                                                                     | ONT and hybrid de novo                          | -                                                                                                              | source (individual installation of each tool)<br>requires conda                                                     | -                                                                               | Linux (could probably use Mac but M1/M2 chips will need "brew"??                                                    | -                                    | https://github.com/genomicsITER/monkeypox/blob/main/codes/code_ONT-and-HybridAssembly_pipeline.md#1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                        |   |
| Viralrecon         | -                                         | -                                                                                  | -                                                                                                                                                                                                                                             | -                                               | -                                                                                                              | -                                                                                                                   | -                                                                               |                                                                                                                     | -                                    | https://github.com/nf-core/viralrecon                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                        |   |
| Broad Institute    | -                                         | -                                                                                  | -                                                                                                                                                                                                                                             | -                                               | -                                                                                                              | -                                                                                                                   | -                                                                               |                                                                                                                     | -                                    | https://github.com/broadinstitute/viral-pipelines/blob/master/README.md                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                        |   |
